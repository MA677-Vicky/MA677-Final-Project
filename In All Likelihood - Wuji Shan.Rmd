---
title: "In All Likelihood - Wuji Shan"
author: "Wuji Shan"
date: "5/7/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(MASS)
library(openxlsx)
library(mle.tools)
library(fitdistrplus)
library(deconvolveR)
```

Using R, prepare answers to exercises 4.25, 4.39, and 4.27.

## Exercise 4.25

```{r}
f <- function(x, mu = 0, sigma = 1) dunif(x, mu, sigma)
F <- function(x, mu = 0, sigma = 1) punif(x, mu, sigma, lower.tail = FALSE)

integrand <- function(x, r, n){
  x * (1 - F(x))^(r - 1) * F(x)^(n - r) * f(x)
}

E <- function(r, n){
  (1/beta(r, n - r + 1)) * integrate(integrand, -Inf, Inf, r, n)$value
}

medianprrox <- function(k, n){
  m <- (k - 1/3) / (n + 1/3)
  return(m)
}
```

```{r}
E(2.5, 5)
```
```{r}
medianprrox(2.5, 5)
```

```{r}
E(5, 10)
```
```{r}
medianprrox(5, 10)
```






